ReportLink:https://hackerone.com/reports/180434
WeaknessName:Server-Side Request Forgery (SSRF)
Reporter:https://hackerone.com/fms
ReportedTo:Data Processing (IBB)(ibb-data)
BountyAmount:500.0
Severity:medium
State:Closed
DateOfDisclosure:11.01.2018 20:41:15

Summary:

invalid URL parsing with '#'
============================

Project cURL Security Advisory, November 2, 2016 -
[Permalink] https://curl.haxx.se/docs/adv_20161102J.html

VULNERABILITY
-------------

curl doesn't parse the authority component of the URL correctly when the host
name part ends with a '#' character, and could instead be tricked into
connecting to a different host. This may have security implications if you for
example use a URL parser that follows the RFC to check for allowed domains
before using curl to request them.

Passing in `http://example.com#@evil.com/x.txt` would wrongly make curl send a
request to evil.com while your browser would connect to example.com given the
same URL.

The problem exists for most protocol schemes.

We are not aware of any exploit of this flaw.

INFO
----

The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2016-8624 to this issue.

AFFECTED VERSIONS
-----------------

This flaw exists in the following curl versions.

- Affected versions: curl 7.1 to and including 7.50.3
- Not affected versions: curl >= 7.51.0

libcurl is used by many applications, but not always advertised as such!

THE SOLUTION
------------

In version 7.51.0, the parser function is fixed.

A [patch for CVE-2016-8624](https://curl.haxx.se/CVE-2016-8624.patch) is
available.

RECOMMENDATIONS
---------------

We suggest you take one of the following actions immediately, in order of
preference:

 A - Upgrade curl and libcurl to version 7.51.0

 B - Apply the patch to your version and rebuild

 C - Strip out the parts of the URLs containing '#' before passing them to curl

TIME LINE
---------

It was first reported to the curl project on October 10 by Fernando Muñoz.

We contacted distros@openwall on October 19.

curl 7.51.0 was released on November 2 2016, coordinated with the publication
of this advisory.

CREDITS
-------

Thanks to Fernando Muñoz!